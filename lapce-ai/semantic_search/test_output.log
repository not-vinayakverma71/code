warning: /home/verma/lapce/lapce-ai-rust/lancedb/Cargo.toml: version requirement `=2.0.8+zstd.1.5.5` for dependency `zstd-sys` includes semver metadata which will be ignored, removing the metadata is recommended to avoid confusion
warning: unused import: `snafu::ResultExt`
  --> src/database/listing.rs:16:5
   |
16 | use snafu::ResultExt;
   |     ^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` on by default

warning: unused import: `crate::Connection`
 --> src/database/code_index_manager.rs:6:5
  |
6 | use crate::Connection;
  |     ^^^^^^^^^^^^^^^^^

warning: unused import: `Error`
 --> src/database/config_manager.rs:5:20
  |
5 | use crate::error::{Error, Result};
  |                    ^^^^^

warning: unused import: `std::collections::HashMap`
 --> src/database/config_manager.rs:7:5
  |
7 | use std::collections::HashMap;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `Context`
 --> src/embeddings/compression.rs:4:22
  |
4 | use anyhow::{Result, Context};
  |                      ^^^^^^^

warning: unused import: `Context`
 --> src/embeddings/mmap_storage.rs:4:22
  |
4 | use anyhow::{Result, Context};
  |                      ^^^^^^^

warning: unused import: `MmapMut`
 --> src/embeddings/mmap_storage.rs:5:21
  |
5 | use memmap2::{Mmap, MmapMut, MmapOptions};
  |                     ^^^^^^^

warning: unused import: `Context`
 --> src/embeddings/hierarchical_cache.rs:4:22
  |
4 | use anyhow::{Result, Context};
  |                      ^^^^^^^

warning: unused import: `std::collections::HashMap`
 --> src/embeddings/hierarchical_cache.rs:7:5
  |
7 | use std::collections::HashMap;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `MmapEmbeddings`
  --> src/embeddings/hierarchical_cache.rs:12:27
   |
12 | use super::mmap_storage::{MmapEmbeddings, ConcurrentMmapStorage};
   |                           ^^^^^^^^^^^^^^

warning: unused import: `AvailableEmbedders`
  --> src/embeddings/optimized_embedder_wrapper.rs:12:77
   |
12 | use super::embedder_interface::{IEmbedder, EmbeddingResponse, EmbedderInfo, AvailableEmbedders};
   |                                                                             ^^^^^^^^^^^^^^^^^^

warning: unused import: `ValidationResult`
 --> src/embeddings/openai_embedder.rs:7:69
  |
7 |     IEmbedder, EmbeddingResponse, EmbedderInfo, AvailableEmbedders, ValidationResult, EmbeddingUsage
  |                                                                     ^^^^^^^^^^^^^^^^

warning: unused import: `Serialize`
  --> src/embeddings/openai_compatible_embedder.rs:11:26
   |
11 | use serde::{Deserialize, Serialize};
   |                          ^^^^^^^^^

warning: unused import: `Mutex`
  --> src/embeddings/openai_compatible_embedder.rs:14:19
   |
14 | use tokio::sync::{Mutex, RwLock};
   |                   ^^^^^

warning: unused import: `std::collections::HashMap`
 --> src/query/codebase_search.rs:9:5
  |
9 | use std::collections::HashMap;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `PathBuf`
  --> src/query/codebase_search.rs:10:23
   |
10 | use std::path::{Path, PathBuf};
   |                       ^^^^^^^

warning: unused import: `crate::processors::scanner::CodeBlock`
 --> src/processors/file_watcher.rs:9:5
  |
9 | use crate::processors::scanner::CodeBlock;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `TreeCursor`
 --> src/processors/cst_to_ast_pipeline.rs:6:49
  |
6 | use tree_sitter::{Node, Tree, Parser, Language, TreeCursor};
  |                                                 ^^^^^^^^^^

warning: unused import: `Node`
  --> src/processors/lapce_integration.rs:10:33
   |
10 | use tree_sitter::{Parser, Tree, Node};
   |                                 ^^^^

warning: unused import: `crate::processors::cst_to_ast_pipeline::AstNodeType`
   --> src/processors/lapce_integration.rs:275:13
    |
275 |         use crate::processors::cst_to_ast_pipeline::AstNodeType;
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `Config`
 --> src/processors/native_file_watcher.rs:6:56
  |
6 | use notify::{Watcher, RecursiveMode, Event, EventKind, Config};
  |                                                        ^^^^^^

warning: unused import: `lance::dataset::Dataset`
  --> src/search/semantic_search_engine.rs:12:5
   |
12 | use lance::dataset::Dataset;
   |     ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `Query as LanceQuery`
  --> src/search/semantic_search_engine.rs:15:20
   |
15 | use crate::query::{Query as LanceQuery, ExecutableQuery, QueryBase};
   |                    ^^^^^^^^^^^^^^^^^^^

warning: unused import: `Duration`
  --> src/search/code_indexer.rs:11:17
   |
11 | use std::time::{Duration, Instant};
   |                 ^^^^^^^^

warning: unused imports: `ArrayRef`, `BinaryArray`, `FixedSizeListArray`, `Float64Array`, `StructArray`, and `UInt32Array`
 --> src/search/optimized_lancedb_storage.rs:7:5
  |
7 |     ArrayRef, Float32Array, StringArray, Int32Array, BinaryArray, 
  |     ^^^^^^^^                                         ^^^^^^^^^^^
8 |     StructArray, RecordBatch, UInt32Array, Float64Array, FixedSizeListArray
  |     ^^^^^^^^^^^               ^^^^^^^^^^^  ^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^^^

warning: unused import: `ArrowError`
  --> src/search/optimized_lancedb_storage.rs:11:55
   |
11 | use arrow_schema::{DataType, Field, Schema, TimeUnit, ArrowError};
   |                                                       ^^^^^^^^^^

warning: unused import: `lance::dataset::Dataset`
  --> src/search/optimized_lancedb_storage.rs:12:5
   |
12 | use lance::dataset::Dataset;
   |     ^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `Query as LanceQuery`
  --> src/search/optimized_lancedb_storage.rs:17:20
   |
17 | use crate::query::{Query as LanceQuery, ExecutableQuery, QueryBase, Select};
   |                    ^^^^^^^^^^^^^^^^^^^

warning: unused import: `Duration`
  --> src/search/optimized_lancedb_storage.rs:23:17
   |
23 | use std::time::{Duration, Instant};
   |                 ^^^^^^^^

warning: unused import: `lance_io::object_store::ObjectStoreParams`
  --> src/search/optimized_lancedb_storage.rs:24:5
   |
24 | use lance_io::object_store::ObjectStoreParams;
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `std::ops::Not`
 --> src/search/ivf_metadata.rs:4:5
  |
4 | use std::ops::Not;
  |     ^^^^^^^^^^^^^

warning: unused import: `crate::embeddings::compression::CompressedEmbedding`
 --> src/search/query_optimizer.rs:7:5
  |
7 | use crate::embeddings::compression::CompressedEmbedding;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::search::query_cache::QueryCache`
 --> src/search/query_optimizer.rs:8:5
  |
8 | use crate::search::query_cache::QueryCache;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `CompressedSearchResult`
 --> src/search/query_optimizer.rs:9:71
  |
9 | use crate::search::optimized_lancedb_storage::{OptimizedLanceStorage, CompressedSearchResult};
  |                                                                       ^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `std::collections::HashMap`
  --> src/search/query_optimizer.rs:13:5
   |
13 | use std::collections::HashMap;
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::processors::file_watcher::FileWatcher`
 --> src/search/incremental_indexer.rs:6:5
  |
6 | use crate::processors::file_watcher::FileWatcher;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `std::collections::VecDeque`
  --> src/search/incremental_indexer.rs:11:5
   |
11 | use std::collections::VecDeque;
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `lance_index::scalar::FullTextSearchQuery`
 --> src/search/hybrid_search.rs:7:5
  |
7 | use lance_index::scalar::FullTextSearchQuery;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `crate::Table`
  --> src/search/hybrid_search.rs:10:5
   |
10 | use crate::Table;
   |     ^^^^^^^^^^^^

warning: unused import: `SearchResult`
 --> src/search/codebase_search_tool.rs:6:67
  |
6 | use crate::search::semantic_search_engine::{SemanticSearchEngine, SearchResult, SearchFilters};
  |                                                                   ^^^^^^^^^^^^

warning: unused import: `l2_norm`
 --> src/optimization/exact_score.rs:5:49
  |
5 | use super::simd_ops::{dot_f32, dot_f32_blocked, l2_norm, compute_block_norms};
  |                                                 ^^^^^^^

warning: use of deprecated function `aws_config::load_from_env`: Use the `aws_config::load_defaults` function. If you don't care about future default behavior changes, you can continue to use this function by enabling the `behavior-version-latest` feature. Doing so will make this deprecation notice go away.
   --> src/embeddings/service_factory.rs:366:34
    |
366 |         let config = aws_config::load_from_env().await;
    |                                  ^^^^^^^^^^^^^
    |
    = note: `#[warn(deprecated)]` on by default

warning: use of deprecated function `aws_config::from_env`: Use the `aws_config::defaults` function. If you don't care about future default behavior changes, you can continue to use this function by enabling the `behavior-version-latest` feature. Doing so will make this deprecation notice go away.
   --> src/embeddings/service_factory.rs:379:34
    |
379 |         let config = aws_config::from_env()
    |                                  ^^^^^^^^

warning: use of deprecated function `base64::decode`: Use Engine::decode
   --> src/embeddings/openai_compatible_embedder.rs:175:53
    |
175 | ...                   let bytes = base64::decode(base64_str).unwrap_or_default();
    |                                           ^^^^^^

warning: use of deprecated function `aws_config::from_env`: Use the `aws_config::defaults` function. If you don't care about future default behavior changes, you can continue to use this function by enabling the `behavior-version-latest` feature. Doing so will make this deprecation notice go away.
   --> src/embeddings/aws_titan_production.rs:130:34
    |
130 |         let config = aws_config::from_env()
    |                                  ^^^^^^^^

warning: unused variable: `orchestrator`
   --> src/database/code_index_manager.rs:301:21
    |
301 |         if let Some(orchestrator) = &self.orchestrator {
    |                     ^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_orchestrator`
    |
    = note: `#[warn(unused_variables)]` on by default

warning: unused variable: `state_manager`
  --> src/index/orchestrator.rs:71:21
   |
71 |                 let state_manager = self.state_manager.clone();
   |                     ^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_state_manager`

warning: unused variable: `file_paths`
  --> src/index/orchestrator.rs:74:80
   |
74 |                 self.file_watcher.on_did_start_batch_processing(Box::new(move |file_paths| {
   |                                                                                ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_file_paths`

warning: unused variable: `path`
   --> src/index/orchestrator.rs:424:9
    |
424 |         path: &Path,
    |         ^^^^ help: if this is intentional, prefix it with an underscore: `_path`

warning: unused variable: `on_batch_error`
   --> src/index/orchestrator.rs:425:9
    |
425 |         on_batch_error: Box<dyn Fn(Error)>,
    |         ^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_on_batch_error`

warning: unused variable: `on_blocks_indexed`
   --> src/index/orchestrator.rs:426:9
    |
426 |         on_blocks_indexed: Box<dyn Fn(usize)>,
    |         ^^^^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_on_blocks_indexed`

warning: unused variable: `on_file_parsed`
   --> src/index/orchestrator.rs:427:9
    |
427 |         on_file_parsed: Box<dyn Fn(usize)>,
    |         ^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_on_file_parsed`

warning: unused variable: `workspace_path`
   --> src/query/codebase_search.rs:138:5
    |
138 |     workspace_path: &Path,
    |     ^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_workspace_path`

warning: unused variable: `text`
   --> src/query/codebase_search.rs:220:29
    |
220 | async fn generate_embedding(text: &str) -> Result<Vec<f32>> {
    |                             ^^^^ help: if this is intentional, prefix it with an underscore: `_text`

warning: unused variable: `directory`
   --> src/processors/scanner.rs:590:21
    |
590 | async fn list_files(directory: &Path, recursive: bool, limit: usize) -> Result<Vec<PathBuf>> {
    |                     ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_directory`

warning: unused variable: `recursive`
   --> src/processors/scanner.rs:590:39
    |
590 | async fn list_files(directory: &Path, recursive: bool, limit: usize) -> Result<Vec<PathBuf>> {
    |                                       ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_recursive`

warning: unused variable: `limit`
   --> src/processors/scanner.rs:590:56
    |
590 | async fn list_files(directory: &Path, recursive: bool, limit: usize) -> Result<Vec<PathBuf>> {
    |                                                        ^^^^^ help: if this is intentional, prefix it with an underscore: `_limit`

warning: variable `last_error` is assigned to, but never used
   --> src/processors/file_watcher.rs:349:29
    |
349 |                     let mut last_error = None;
    |                             ^^^^^^^^^^
    |
    = note: consider using `_last_error` instead

warning: value assigned to `last_error` is never read
   --> src/processors/file_watcher.rs:355:33
    |
355 | ...                   last_error = Some(error);
    |                       ^^^^^^^^^^
    |
    = help: maybe it is overwritten before being read?
    = note: `#[warn(unused_assignments)]` on by default

warning: value assigned to `processed_count` is never read
   --> src/processors/file_watcher.rs:447:9
    |
447 |         processed_count = processed_count_after_files;
    |         ^^^^^^^^^^^^^^^
    |
    = help: maybe it is overwritten before being read?

warning: unused variable: `cst`
  --> src/processors/lapce_integration.rs:41:13
   |
41 |         let cst = self.get_cst_from_mega_parser(path).await?;
   |             ^^^ help: if this is intentional, prefix it with an underscore: `_cst`

warning: unused variable: `path`
  --> src/search/query_cache.rs:82:44
   |
82 |     pub async fn invalidate_by_path(&self, path: &str) {
   |                                            ^^^^ help: if this is intentional, prefix it with an underscore: `_path`

warning: unused variable: `column`
   --> src/search/optimized_lancedb_storage.rs:345:9
    |
345 |         column: &str,
    |         ^^^^^^ help: if this is intentional, prefix it with an underscore: `_column`

warning: unused variable: `table`
   --> src/search/optimized_lancedb_storage.rs:614:42
    |
614 |     pub async fn enable_mmap_mode(&self, table: &Arc<Table>) -> Result<()> {
    |                                          ^^^^^ help: if this is intentional, prefix it with an underscore: `_table`

warning: unused variable: `assignments`
   --> src/search/ivf_metadata.rs:114:21
    |
114 |     let (centroids, assignments) = kmeans_lloyd(&sampled, num_lists, 25)?; // 25 iters
    |                     ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_assignments`

warning: unused variable: `watch_path`
  --> src/search/incremental_indexer.rs:69:31
   |
69 |     pub async fn start(&self, watch_path: PathBuf) -> Result<()> {
   |                               ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_watch_path`

warning: unused variable: `change_buffer`
  --> src/search/incremental_indexer.rs:71:13
   |
71 |         let change_buffer = self.change_buffer.clone();
   |             ^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_change_buffer`

warning: unused variable: `code_indexer`
  --> src/search/incremental_indexer.rs:72:13
   |
72 |         let code_indexer = self.code_indexer.clone();
   |             ^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_code_indexer`

warning: unused variable: `query_cache`
  --> src/search/incremental_indexer.rs:73:13
   |
73 |         let query_cache = self.query_cache.clone();
   |             ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_query_cache`

warning: unused variable: `rel_dir_path`
  --> src/search/search_files_tool.rs:88:13
   |
88 |         let rel_dir_path = match rel_dir_path {
   |             ^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_rel_dir_path`

warning: unused import: `snafu::ResultExt`
  --> src/catalog/listing.rs:23:5
   |
23 | use snafu::ResultExt;
   |     ^^^^^^^^^^^^^^^^

warning: unused import: `futures::StreamExt`
  --> src/search/optimized_lancedb_storage.rs:26:5
   |
26 | use futures::StreamExt;
   |     ^^^^^^^^^^^^^^^^^^

warning: unused import: `futures::TryStreamExt`
  --> src/search/semantic_search_engine.rs:11:5
   |
11 | use futures::TryStreamExt;
   |     ^^^^^^^^^^^^^^^^^^^^^

warning: unused variable: `orchestrator`
   --> src/database/code_index_manager.rs:257:21
    |
257 |         if let Some(orchestrator) = &self.orchestrator {
    |                     ^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_orchestrator`

warning: unused variable: `state`
   --> src/database/code_index_manager.rs:467:36
    |
467 |     pub fn set_system_state(&self, state: IndexingState, message: Option<String>) {
    |                                    ^^^^^ help: if this is intentional, prefix it with an underscore: `_state`

warning: unused variable: `message`
   --> src/database/code_index_manager.rs:467:58
    |
467 |     pub fn set_system_state(&self, state: IndexingState, message: Option<String>) {
    |                                                          ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_message`

warning: variable `total_tokens` is assigned to, but never used
   --> src/embeddings/service_factory.rs:401:17
    |
401 |         let mut total_tokens = 0;
    |                 ^^^^^^^^^^^^
    |
    = note: consider using `_total_tokens` instead

warning: unused variable: `provider`
   --> src/embeddings/openai_embedder.rs:301:27
    |
301 | fn get_model_query_prefix(provider: &str, model: &str) -> Option<String> {
    |                           ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_provider`

warning: unused variable: `model`
   --> src/embeddings/openai_embedder.rs:301:43
    |
301 | fn get_model_query_prefix(provider: &str, model: &str) -> Option<String> {
    |                                           ^^^^^ help: if this is intentional, prefix it with an underscore: `_model`

warning: unused variable: `metrics`
   --> src/embeddings/aws_titan_production.rs:434:21
    |
434 |                 let metrics = self.get_metrics().await;
    |                     ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_metrics`

warning: unused variable: `state`
   --> src/query/search_service.rs:200:36
    |
200 |     pub fn set_system_state(&self, state: IndexingState, message: Option<String>) {
    |                                    ^^^^^ help: if this is intentional, prefix it with an underscore: `_state`

warning: unused variable: `message`
   --> src/query/search_service.rs:200:58
    |
200 |     pub fn set_system_state(&self, state: IndexingState, message: Option<String>) {
    |                                                          ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_message`

warning: value assigned to `chunk_start_line_index` is never read
   --> src/processors/parser.rs:182:21
    |
182 |                     chunk_start_line_index = i;
    |                     ^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: maybe it is overwritten before being read?

warning: unused variable: `file_hash`
   --> src/processors/parser.rs:107:9
    |
107 |         file_hash: &str,
    |         ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_file_hash`

warning: unused variable: `chunk_type`
   --> src/processors/parser.rs:108:9
    |
108 |         chunk_type: &str,
    |         ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_chunk_type`

warning: unnecessary `unsafe` block
   --> src/processors/cst_to_ast_pipeline.rs:307:26
    |
307 |             "rust" => Ok(unsafe { tree_sitter_rust::language() }),
    |                          ^^^^^^ unnecessary `unsafe` block
    |
    = note: `#[warn(unused_unsafe)]` on by default

warning: unnecessary `unsafe` block
   --> src/processors/cst_to_ast_pipeline.rs:308:32
    |
308 |             "javascript" => Ok(unsafe { tree_sitter_javascript::language() }),
    |                                ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
   --> src/processors/cst_to_ast_pipeline.rs:309:32
    |
309 |             "typescript" => Ok(unsafe { tree_sitter_typescript::language_typescript() }),
    |                                ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
   --> src/processors/cst_to_ast_pipeline.rs:310:28
    |
310 |             "python" => Ok(unsafe { tree_sitter_python::language() }),
    |                            ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
   --> src/processors/cst_to_ast_pipeline.rs:311:24
    |
311 |             "go" => Ok(unsafe { tree_sitter_go::language() }),
    |                        ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
   --> src/processors/cst_to_ast_pipeline.rs:312:26
    |
312 |             "java" => Ok(unsafe { tree_sitter_java::language() }),
    |                          ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
  --> src/processors/lapce_integration.rs:76:23
   |
76 |             "rust" => unsafe { tree_sitter_rust::language() },
   |                       ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
  --> src/processors/lapce_integration.rs:77:29
   |
77 |             "javascript" => unsafe { tree_sitter_javascript::language() },
   |                             ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
  --> src/processors/lapce_integration.rs:78:29
   |
78 |             "typescript" => unsafe { tree_sitter_typescript::language_typescript() },
   |                             ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
  --> src/processors/lapce_integration.rs:79:25
   |
79 |             "python" => unsafe { tree_sitter_python::language() },
   |                         ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
  --> src/processors/lapce_integration.rs:80:21
   |
80 |             "go" => unsafe { tree_sitter_go::language() },
   |                     ^^^^^^ unnecessary `unsafe` block

warning: unnecessary `unsafe` block
  --> src/processors/lapce_integration.rs:81:23
   |
81 |             "java" => unsafe { tree_sitter_java::language() },
   |                       ^^^^^^ unnecessary `unsafe` block

warning: unused variable: `embedding`
   --> src/search/optimized_lancedb_storage.rs:600:26
    |
600 |     fn lsh_filter(&self, embedding: &[f32], num_candidates: usize) -> Vec<usize> {
    |                          ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_embedding`

warning: type `CodebaseIndexConfigState` is more private than the item `ContextProxy::get_global_state`
   --> src/database/config_manager.rs:546:5
    |
546 |     fn get_global_state(&self, key: &str) -> Option<CodebaseIndexConfigState>;
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ method `ContextProxy::get_global_state` is reachable at visibility `pub`
    |
note: but type `CodebaseIndexConfigState` is only usable at visibility `pub(self)`
   --> src/database/config_manager.rs:531:1
    |
531 | struct CodebaseIndexConfigState {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(private_interfaces)]` on by default

warning: type `IndexAction` is more private than the item `CodeIndexer::queue_file`
   --> src/search/code_indexer.rs:176:5
    |
176 |     pub async fn queue_file(&self, path: PathBuf, action: IndexAction) {
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ method `CodeIndexer::queue_file` is reachable at visibility `pub`
    |
note: but type `IndexAction` is only usable at visibility `pub(self)`
   --> src/search/code_indexer.rs:30:1
    |
30  | enum IndexAction {
    | ^^^^^^^^^^^^^^^^

warning: field `instances` is never read
  --> src/database/code_index_manager.rs:26:5
   |
24 | pub struct CodeIndexManager {
   |            ---------------- field in this struct
25 |     // Line 22: Singleton instances map
26 |     instances: Arc<Mutex<HashMap<PathBuf, Arc<CodeIndexManager>>>>,
   |     ^^^^^^^^^
   |
   = note: `#[warn(dead_code)]` on by default

warning: field `compression_level` is never read
   --> src/embeddings/compression.rs:247:5
    |
246 | pub struct BatchCompressor {
    |            --------------- field in this struct
247 |     compression_level: i32,
    |     ^^^^^^^^^^^^^^^^^

warning: method `predict_next_access` is never used
   --> src/embeddings/mmap_storage.rs:388:8
    |
343 | impl ConcurrentMmapStorage {
    | -------------------------- method in this implementation
...
388 |     fn predict_next_access(&self, current: &str) -> Option<String> {
    |        ^^^^^^^^^^^^^^^^^^^

warning: constant `PAGE_SIZE` is never used
   --> src/embeddings/mmap_storage.rs:375:15
    |
375 |         const PAGE_SIZE: usize = 4096;
    |               ^^^^^^^^^

warning: struct `CacheEntry` is never constructed
  --> src/embeddings/hierarchical_cache.rs:16:8
   |
16 | struct CacheEntry {
   |        ^^^^^^^^^^

warning: method `should_promote` is never used
   --> src/embeddings/hierarchical_cache.rs:260:8
    |
119 | impl HierarchicalCache {
    | ---------------------- method in this implementation
...
260 |     fn should_promote(&self, key: &str) -> bool {
    |        ^^^^^^^^^^^^^^

warning: method `process_single_text` is never used
   --> src/embeddings/optimized_embedder_wrapper.rs:127:14
    |
94  | impl OptimizedEmbedderWrapper {
    | ----------------------------- method in this implementation
...
127 |     async fn process_single_text(&self, text: &str) -> anyhow::Result<Vec<f32>> {
    |              ^^^^^^^^^^^^^^^^^^^

warning: field `model` is never read
   --> src/embeddings/service_factory.rs:360:5
    |
355 | pub struct AwsTitanEmbedder {
    |            ---------------- field in this struct
...
360 |     model: String, // fallback type when bedrock feature is disabled
    |     ^^^^^

warning: fields `workspace_path`, `url`, `vector_size`, and `api_key` are never read
   --> src/embeddings/service_factory.rs:462:5
    |
461 | pub struct LanceDbVectorStore {
    |            ------------------ fields in this struct
462 |     workspace_path: PathBuf,
    |     ^^^^^^^^^^^^^^
463 |     url: String,
    |     ^^^
464 |     vector_size: usize,
    |     ^^^^^^^^^^^
465 |     api_key: Option<String>,
    |     ^^^^^^^

warning: fields `embedder`, `vector_store`, `parser`, `cache_manager`, and `ignore_instance` are never read
   --> src/embeddings/service_factory.rs:515:5
    |
514 | pub struct DirectoryScanner {
    |            ---------------- fields in this struct
515 |     embedder: Arc<dyn IEmbedder>,
    |     ^^^^^^^^
516 |     vector_store: Arc<dyn IVectorStore>,
    |     ^^^^^^^^^^^^
517 |     parser: Arc<dyn ICodeParser>,
    |     ^^^^^^
518 |     cache_manager: Arc<CacheManager>,
    |     ^^^^^^^^^^^^^
519 |     ignore_instance: Arc<dyn Ignore>,
    |     ^^^^^^^^^^^^^^^

warning: multiple fields are never read
   --> src/embeddings/service_factory.rs:542:5
    |
541 | pub struct FileWatcher {
    |            ----------- fields in this struct
542 |     workspace_path: PathBuf,
    |     ^^^^^^^^^^^^^^
543 |     context: Arc<dyn std::any::Any + Send + Sync>,
    |     ^^^^^^^
544 |     cache_manager: Arc<CacheManager>,
    |     ^^^^^^^^^^^^^
545 |     embedder: Arc<dyn IEmbedder>,
    |     ^^^^^^^^
546 |     vector_store: Arc<dyn IVectorStore>,
    |     ^^^^^^^^^^^^
547 |     ignore_instance: Arc<dyn Ignore>,
    |     ^^^^^^^^^^^^^^^
548 |     roo_ignore_controller: Option<Arc<RooIgnoreController>>,
    |     ^^^^^^^^^^^^^^^^^^^^^

warning: field `extra` is never read
  --> src/embeddings/openai_compatible_embedder.rs:24:5
   |
21 | struct EmbeddingItem {
   |        ------------- field in this struct
...
24 |     extra: serde_json::Map<String, serde_json::Value>,
   |     ^^^^^
   |
   = note: `EmbeddingItem` has a derived impl for the trait `Debug`, but this is intentionally ignored during dead code analysis

warning: method `max_tokens_per_minute` is never used
  --> src/embeddings/aws_titan_production.rs:33:8
   |
23 | impl AwsTier {
   | ------------ method in this implementation
...
33 |     fn max_tokens_per_minute(&self) -> usize {
   |        ^^^^^^^^^^^^^^^^^^^^^

warning: field `text_hash` is never read
  --> src/embeddings/aws_titan_production.rs:56:5
   |
54 | struct CachedEmbedding {
   |        --------------- field in this struct
55 |     embedding: Vec<f32>,
56 |     text_hash: u64,
   |     ^^^^^^^^^
   |
   = note: `CachedEmbedding` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: variants `BatchStart`, `BatchProgress`, and `BatchFinish` are never constructed
   --> src/index/orchestrator.rs:395:5
    |
394 | enum WatcherSubscription {
    |      ------------------- variants in this enum
395 |     BatchStart,
    |     ^^^^^^^^^^
396 |     BatchProgress,
    |     ^^^^^^^^^^^^^
397 |     BatchFinish,
    |     ^^^^^^^^^^^
    |
    = note: `WatcherSubscription` has a derived impl for the trait `Clone`, but this is intentionally ignored during dead code analysis

warning: field `directory` is never read
   --> src/processors/scanner.rs:570:5
    |
569 | struct RooIgnoreController {
    |        ------------------- field in this struct
570 |     directory: PathBuf,
    |     ^^^^^^^^^

warning: constant `QDRANT_CODE_BLOCK_NAMESPACE` is never used
  --> src/processors/file_watcher.rs:20:7
   |
20 | const QDRANT_CODE_BLOCK_NAMESPACE: Uuid = Uuid::from_u128(0x12345678_1234_5678_1234_567812345678);
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: constant `MAX_FILE_SIZE_BYTES` is never used
  --> src/processors/file_watcher.rs:21:7
   |
21 | const MAX_FILE_SIZE_BYTES: u64 = 10 * 1024 * 1024;
   |       ^^^^^^^^^^^^^^^^^^^

warning: constant `BATCH_SEGMENT_THRESHOLD` is never used
  --> src/processors/file_watcher.rs:22:7
   |
22 | const BATCH_SEGMENT_THRESHOLD: usize = 100;
   |       ^^^^^^^^^^^^^^^^^^^^^^^

warning: constant `MAX_BATCH_RETRIES` is never used
  --> src/processors/file_watcher.rs:23:7
   |
23 | const MAX_BATCH_RETRIES: usize = 3;
   |       ^^^^^^^^^^^^^^^^^

warning: constant `INITIAL_RETRY_DELAY_MS` is never used
  --> src/processors/file_watcher.rs:24:7
   |
24 | const INITIAL_RETRY_DELAY_MS: u64 = 1000;
   |       ^^^^^^^^^^^^^^^^^^^^^^

warning: constant `BATCH_DEBOUNCE_DELAY_MS` is never used
  --> src/processors/file_watcher.rs:25:7
   |
25 | const BATCH_DEBOUNCE_DELAY_MS: u64 = 500;
   |       ^^^^^^^^^^^^^^^^^^^^^^^

warning: constant `FILE_PROCESSING_CONCURRENCY_LIMIT` is never used
  --> src/processors/file_watcher.rs:26:7
   |
26 | const FILE_PROCESSING_CONCURRENCY_LIMIT: usize = 10;
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

warning: multiple fields are never read
  --> src/processors/file_watcher.rs:30:5
   |
29 | pub struct FileWatcher {
   |            ----------- fields in this struct
30 |     workspace_path: PathBuf,
   |     ^^^^^^^^^^^^^^
31 |     context: Arc<dyn std::any::Any + Send + Sync>,
   |     ^^^^^^^
32 |     cache_manager: Arc<dyn ICacheManager>,
   |     ^^^^^^^^^^^^^
33 |     embedder: Option<Arc<dyn IEmbedder>>,
   |     ^^^^^^^^
34 |     vector_store: Option<Arc<dyn IVectorStore>>,
   |     ^^^^^^^^^^^^
35 |     ignore_instance: Option<Arc<dyn Ignore>>,
   |     ^^^^^^^^^^^^^^^
36 |     ignore_controller: Option<Arc<RooIgnoreController>>,
   |     ^^^^^^^^^^^^^^^^^

warning: fields `path` and `event_type` are never read
  --> src/processors/file_watcher.rs:45:5
   |
44 | struct FileEvent {
   |        --------- fields in this struct
45 |     path: PathBuf,
   |     ^^^^
46 |     event_type: FileEventType,
   |     ^^^^^^^^^^
   |
   = note: `FileEvent` has a derived impl for the trait `Clone`, but this is intentionally ignored during dead code analysis

warning: variants `Create`, `Change`, and `Delete` are never constructed
  --> src/processors/file_watcher.rs:51:5
   |
50 | enum FileEventType {
   |      ------------- variants in this enum
51 |     Create,
   |     ^^^^^^
52 |     Change,
   |     ^^^^^^
53 |     Delete,
   |     ^^^^^^
   |
   = note: `FileEventType` has a derived impl for the trait `Clone`, but this is intentionally ignored during dead code analysis

warning: multiple methods are never used
   --> src/processors/file_watcher.rs:103:14
    |
56  | impl FileWatcher {
    | ---------------- methods in this implementation
...
103 |     async fn handle_file_created(&self, path: PathBuf) {
    |              ^^^^^^^^^^^^^^^^^^^
...
115 |     async fn handle_file_changed(&self, path: PathBuf) {
    |              ^^^^^^^^^^^^^^^^^^^
...
127 |     async fn handle_file_deleted(&self, path: PathBuf) {
    |              ^^^^^^^^^^^^^^^^^^^
...
139 |     async fn schedule_batch_processing(&self) {
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
...
146 |     async fn trigger_batch_processing(&self) {
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
...
167 |     async fn handle_batch_deletions(
    |              ^^^^^^^^^^^^^^^^^^^^^^
...
245 |     async fn process_files_and_prepare_upserts(
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
...
335 |     async fn execute_batch_upsert_operations(
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
...
408 |     async fn process_batch(&self, events: HashMap<PathBuf, FileEvent>) {
    |              ^^^^^^^^^^^^^
...
465 |     async fn process_file(&self, path: &Path) -> Result<FileProcessingResult> {
    |              ^^^^^^^^^^^^

warning: struct `ProcessedFile` is never constructed
   --> src/processors/file_watcher.rs:598:8
    |
598 | struct ProcessedFile {
    |        ^^^^^^^^^^^^^

warning: field `directory` is never read
   --> src/processors/file_watcher.rs:610:5
    |
609 | pub struct RooIgnoreController {
    |            ------------------- field in this struct
610 |     directory: PathBuf,
    |     ^^^^^^^^^

warning: field `mega_parser_path` is never read
  --> src/processors/lapce_integration.rs:15:5
   |
13 | pub struct LapceTreeSitterBridge {
   |            --------------------- field in this struct
14 |     /// Reference to lapce-tree-sitter's MegaParser
15 |     mega_parser_path: PathBuf,
   |     ^^^^^^^^^^^^^^^^

warning: field `config` is never read
  --> src/search/semantic_search_engine.rs:73:5
   |
55 | pub struct SemanticSearchEngine {
   |            -------------------- field in this struct
...
73 |     config: SearchConfig,
   |     ^^^^^^

warning: variants `Add`, `Update`, and `Delete` are never constructed
  --> src/search/code_indexer.rs:31:5
   |
30 | enum IndexAction {
   |      ----------- variants in this enum
31 |     Add,
   |     ^^^
32 |     Update,
   |     ^^^^^^
33 |     Delete,
   |     ^^^^^^
   |
   = note: `IndexAction` has derived impls for the traits `Clone` and `Debug`, but these are intentionally ignored during dead code analysis

warning: method `lsh_filter` is never used
   --> src/search/optimized_lancedb_storage.rs:600:8
    |
120 | impl OptimizedLanceStorage {
    | -------------------------- method in this implementation
...
600 |     fn lsh_filter(&self, embedding: &[f32], num_candidates: usize) -> Vec<usize> {
    |        ^^^^^^^^^^

warning: `lancedb` (lib) generated 133 warnings (run `cargo fix --lib -p lancedb` to apply 41 suggestions)
   Compiling lancedb v0.22.1-beta.1 (/home/verma/lapce/lapce-ai-rust/lancedb)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 2m 00s
     Running tests/final_optimized_test.rs (target/debug/deps/final_optimized_test-d2d4a3f5012c6f95)

running 1 test

🚀 FINAL COMPREHENSIVE PERFORMANCE TEST
=======================================
Testing optimized LanceDB with:
  • 50+ source files from multiple languages
  • Smart batching to avoid rate limits
  • Real AWS Titan embeddings
  • Full optimization pipeline
  • 0% quality loss verification

🔐 Initializing AWS Titan...
✅ Connected: AWS Bedrock Titan configured (Tier: Standard, Cache: 0 entries)

📁 PHASE 1: COLLECTING DIVERSE SOURCE FILES
============================================

📊 File Statistics:
   .rs: 10 files
   .md: 9 files
   .toml: 1 files
   Total: 20 files

🧠 PHASE 2: SMART BATCH EMBEDDING
==================================
📦 Batch 1/2
   ✅ 9 embeddings in 3.932856601s
      • lib.rs compressed to 40.4% in 22.694118ms
      • remote.rs compressed to 40.4% in 56.370538ms
      • ipc.rs compressed to 40.3% in 18.398ms
      • polars_arrow_convertors.rs compressed to 40.4% in 22.657535ms
      • utils.rs compressed to 40.2% in 11.924172ms
      • table.rs compressed to 40.4% in 11.600839ms
      • embeddings.rs compressed to 40.1% in 10.852113ms
      • query.rs compressed to 40.4% in 11.227329ms
      • catalog.rs compressed to 40.5% in 16.810173ms
   ⏱️ Rate limit delay: 2s
📦 Batch 2/2
   ✅ 9 embeddings in 4.961921462s
      • zero_quality_loss_optimizations.md compressed to 40.4% in 4.236711ms
      • IMPLEMENTATION_TODO.md compressed to 40.1% in 3.567274ms
      • IMPLEMENTATION_SUMMARY.md compressed to 40.3% in 2.871712ms
      • FULL_6_TASKS_INTEGRATION_SUMMARY.md compressed to 40.6% in 2.618539ms
      • TASK5_COMPLETION_REPORT.md compressed to 40.3% in 2.667713ms
      • PRODUCTION_INTEGRATION_COMPLETE.md compressed to 40.4% in 3.825874ms
      • README.md compressed to 40.3% in 3.258338ms
      • TASK6_COMPLETION_REPORT.md compressed to 40.4% in 3.604593ms
      • Cargo.toml compressed to 93.2% in 2.806752ms

📈 Embedding Statistics:
   Total embeddings created: 18
   Compression achieved: All bit-perfect ✅

💾 PHASE 3: STORAGE & INDEXING
===============================
   ✅ Stored 18 embeddings in 20.706144ms

🔍 PHASE 4: QUERY PERFORMANCE TESTING
======================================

🎯 Query 1: "async function implementation with error handling"
   Embedding: 767.256339ms
   Standard: 21.912132ms (5 results)
   Adaptive: 45.445384ms (5 results)
   Top result: ipc.rs (score: 0.0022)

🎯 Query 2: "struct definition with derive macros"
   Embedding: 653.282304ms
   Standard: 15.265981ms (5 results)
   Adaptive: 29.882875ms (5 results)
   Top result: README.md (score: 0.0023)

🎯 Query 3: "compression algorithm for embeddings"
   Embedding: 475.174251ms
   Standard: 25.409893ms (5 results)
   Adaptive: 37.895003ms (5 results)
   Top result: zero_quality_loss_optimizations.md (score: 0.0036)

🎯 Query 4: "vector search optimization techniques"
   Embedding: 470.654854ms
   Standard: 21.739142ms (5 results)
   Adaptive: 35.193286ms (5 results)
   Top result: IMPLEMENTATION_SUMMARY.md (score: 0.0022)

🎯 Query 5: "trait implementation for custom types"
   Embedding: 466.664464ms
   Standard: 20.747872ms (5 results)
   Adaptive: 31.481295ms (5 results)
   Top result: utils.rs (score: 0.0024)

🎯 Query 6: "memory management and caching strategies"
   Embedding: 467.616827ms
   Standard: 22.202017ms (5 results)
   Adaptive: 25.476282ms (5 results)
   Top result: IMPLEMENTATION_TODO.md (score: 0.0023)

📊 FINAL PERFORMANCE SUMMARY
=============================

📈 Query Latency (Standard):
   Average: 21.212839ms
   P50: 21.739142ms
   P95: 22.202017ms

🚀 Query Latency (Optimized):
   Average: 34.22902ms
   P50: 35.193286ms
   P95: 25.476282ms

🎯 Quality Metrics:
   Quality Score: 100.0%
   0% Loss Verified: ✅ YES

✅ TEST COMPLETE
   Files processed: 18
   Languages tested: 3
   Compression: Bit-perfect ✅
   Adaptive search: Working ✅
   Int8 filtering: Enabled ✅

🏆 Performance Targets:
   P50 < 5ms: ❌ MISSED
   P95 < 8ms: ❌ MISSED
   0% Quality Loss: ✅ ACHIEVED
test test_final_optimized_system ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 20.32s

