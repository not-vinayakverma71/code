[package]
name = "lapce-ai-rust"
version = "1.0.0"
edition = "2021"
authors = ["Lapce Team"]
description = "High-performance IPC system with shared memory, vector search, and caching"
license = "MIT OR Apache-2.0"
repository = "https://github.com/lapce/lapce-ai-rust"
keywords = ["ipc", "shared-memory", "vector-search", "cache", "lapce"]
categories = ["concurrency", "caching", "algorithms", "network-programming"]

[workspace]

# [[bin]]
# name = "lapce-ai-rust"
# path = "src/main.rs"


# Commented out test binaries that have missing dependencies
# [[bin]]
# name = "test_lancedb_basic"
# path = "src/bin/test_lancedb_basic.rs"

# [[bin]]
# name = "real_semantic_search"
# path = "src/bin/real_semantic_search.rs"

# [[bin]]
# name = "lancedb_titan_search"
# path = "src/bin/lancedb_titan_search.rs"

# [[bin]]
# name = "test_codex_translation"
# path = "src/bin/test_codex_translation.rs"

[lib]
path = "src/lib.rs"

[[bench]]
name = "benchmarks"
harness = false

[dev-dependencies]
criterion = { version = "0.5", features = ["html_reports"] }

[target.'cfg(windows)'.dependencies]
winapi = { version = "0.3", features = ["handleapi", "memoryapi", "winnt", "minwindef"] }
anyhow = "1.0"

[target.'cfg(target_os = "macos")'.dependencies]
libc = "0.2"
anyhow = "1.0"

[target.'cfg(unix)'.dependencies]
libc = "0.2"

[dependencies]
anyhow = "1.0"
serde_json = "1.0"
chrono = "0.4"
notify = "6.0"
warp = "0.3"
reqwest = { version = "0.11", features = ["json"] }
# Use local LanceDB instead of crates.io version
lancedb = { path = "../lancedb/rust/lancedb" }
tantivy = "0.22"
# rusqlite = { version = "0.32", features = ["bundled", "blob"] }  # Already exists below
arrow = "52.0"
arrow-array = "52.0"
arrow-schema = "52.0"
arrow-cast = "52.0"
# candle-core = "0.6"  # Disabled - AWS SDK issues
aws-config = "1.5"
aws-sdk-bedrockruntime = "1.39"
hf-hub = "0.3"
memmap2 = "0.9"
nix = { version = "0.29", features = ["signal"] }
governor = "0.6"
grep = "0.3"
# Core
tokio = { version = "1.35", features = ["full"] }
tokio-stream = "0.1"
async-trait = "0.1"
serde = { version = "1.0", features = ["derive"] }
futures-util = "0.3"
toml = "0.8"
flate2 = "1.0"
sd-notify = "0.4"
clap = { version = "4.4", features = ["derive"] }
bytes = "1.5"
bincode = "1.3"
rmp-serde = "1.1"
crossbeam = "0.8"
rayon = "1.10"
sysinfo = "0.31"
tokio-util = { version = "0.7", features = ["io"] }

# Embedding and ML
tokenizers = "0.19"
parking_lot = "0.12"
dashmap = "6.1"

# Storage and caching
sled = "0.34"
redis = { version = "0.24", features = ["aio", "tokio-comp", "connection-manager"] }

# Compression
lz4_flex = "0.11"
# zstd = "0.13"

# Utilities
regex = "1.10"
tracing = "0.1"
rand = "0.8"
rkyv = { version = "0.7", features = ["validation"] }
zstd = "0.13"
mimalloc = { version = "0.1", optional = true }
prometheus = "0.13"
blake3 = "1.5"
shared_memory = "0.12"
raw_sync = "0.1"
arc-swap = "1.7"
clap = { version = "4.5", features = ["derive"] }
uuid = { version = "1.11", features = ["v4", "serde"] }
mlua = { version = "0.10", features = ["lua54", "vendored", "async", "send"] }
ort = { version = "2.0.0-rc.8", optional = true, features = ["download-binaries"] }
ndarray = "0.16"
candle-core = { version = "0.8", optional = true }
candle-transformers = { version = "0.8", optional = true }
candle-nn = { version = "0.8", optional = true }
tokenizers = "0.21"
lsp-types = "0.95"
lsp-server = "0.7"
ropey = "1.6"
moka = { version = "0.12", features = ["future"] }
juniper = "0.16"
warp = "0.3"
reqwest = { version = "0.12", features = ["json", "stream"] }
async-graphql = "7.0"
async-graphql-axum = "7.0"
utoipa = { version = "5.2", features = ["axum_extras"] }
utoipa-swagger-ui = { version = "8.0", features = ["axum"] }
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
directories = "5.0"
aws-config = "1.5"
aws-sdk-bedrock = "1.72"
aws-sdk_bedrockruntime = "1.78"
sea-orm = { version = "1.1", features = ["runtime-tokio-rustls", "sqlx-sqlite"] }
sea-orm-migration = "1.1"
criterion = { version = "0.5", features = ["async-tokio"] }
chrono = "0.4"
sha2 = "0.10"
hmac = "0.13"
url = "2.5"
once_cell = "1.19"
dirs = "5.0"
zstd = "0.13"
ndarray = "0.15"
# notify = "6.1"  # Already defined above
# governor = "0.6"  # Duplicate - using above
# grep = "0.3"  # Duplicate - using above
ignore = "0.4"
git2 = "0.18"
thiserror = "1.0"
num_cpus = "1.16"
# async-graphql-axum = "6.0"  # Duplicate - using version 7.0 above
opentelemetry = "0.21"
opentelemetry-otlp = "0.14"
tracing-opentelemetry = "0.22"
tempfile = "3.8"
serde_yaml = "0.9"
arbitrary = { version = "1.3", features = ["derive"] }
# jsonwebtoken = "9.2"  # Duplicate - already defined above
aes-gcm = "0.10"
argon2 = "0.5"
pbkdf2 = "0.12"
rustls = "0.21"
rustls-pemfile = "1.0"
base64 = "0.21"

# Test dependencies already defined above
# criterion = "0.5"
# proptest = "1.4"
mockito = "1.2"
tiktoken-rs = "0.7.0"
async-stream = "0.3.6"
url = "2.5.7"

[build-dependencies]
tonic-build = "0.10"
